# SINR 計算 Cheat Sheet
## 訊號、干擾與噪聲比

### 核心概念

| 術語 | 符號 | 說明 |
|------|------|------|
| **SINR** | Signal-to-Interference-plus-Noise Ratio | 訊號、干擾與噪聲比 |
| **SNR** | Signal-to-Noise Ratio | 訊號與噪聲比（無干擾時） |
| **SIR** | Signal-to-Interference Ratio | 訊號與干擾比（無噪聲時） |
| **BER** | Bit Error Rate | 位元錯誤率 |
| **SINR_th** | SINR Threshold | SINR 閾值（阻斷判斷） |

### 基本公式

| 公式 | 數學表達式 | 說明 |
|------|-----------|------|
| **SINR (線性)** | `SINR = P_Rx / (J_total + N)` | 線性功率比 |
| **SINR (dB)** | `SINR_dB = 10*log₁₀(SINR)` | 分貝表示 |
| **總干擾** | `J_total = Σ J_i` | 所有干擾源之和 |
| **熱噪聲** | `N = k*T_sys*B` | 系統熱噪聲功率 |

### 參數定義

| 參數 | 符號 | 單位 | 說明 |
|------|------|------|------|
| 接收訊號功率 | `P_Rx` | W 或 dBW | 來自目標發射源的功率 |
| 單個干擾功率 | `J_i` | W 或 dBW | 第 i 個干擾源的功率 |
| 總干擾功率 | `J_total` | W 或 dBW | 所有干擾源的總和 |
| 系統噪聲功率 | `N` | W 或 dBW | 接收機熱噪聲 |
| 系統噪聲溫度 | `T_sys` | K (開爾文) | 接收機等效噪聲溫度 |
| 系統頻寬 | `B` | Hz | 接收機頻寬 |
| 玻爾茲曼常數 | `k` | 1.380649×10⁻²³ J/K | 物理常數 |

### 計算步驟

| 步驟 | 計算 | 說明 |
|------|------|------|
| 1. 計算接收訊號 | `P_Rx = f(Tx_coord, Rx_coord, ...)` | 鏈路預算 |
| 2. 計算各干擾源 | `J_i = f(Jammer_i_coord, Rx_coord, ...)` | 每個干擾源 |
| 3. 累加干擾 | `J_total = Σ J_i` (線性) | 功率相加需用線性單位 |
| 4. 計算噪聲 | `N = k*T_sys*B` | 系統熱噪聲 |
| 5. 計算 SINR | `SINR = P_Rx / (J_total + N)` | 線性計算 |
| 6. 轉換為 dB | `SINR_dB = 10*log₁₀(SINR)` | 分貝表示 |

### 功率單位轉換

| 操作 | 方法 | 說明 |
|------|------|------|
| **dBW → W** | `P_W = 10^(P_dBW/10)` | 分貝瓦轉瓦特 |
| **W → dBW** | `P_dBW = 10*log₁₀(P_W)` | 瓦特轉分貝瓦 |
| **功率相加** | 先轉 W，相加，再轉 dBW | 必須用線性單位相加 |

### 噪聲功率計算

| 參數 | 典型值 | 說明 |
|------|--------|------|
| `T_sys` | 290 K | 室溫 (標準參考溫度) |
| `B` | 10 MHz | 典型系統頻寬 |
| `N` (計算) | -134 dBW | `k*T_sys*B` 在 290K, 10MHz |

### 典型 SINR 值

| SINR (dB) | 通訊狀態 | 說明 |
|-----------|---------|------|
| > 10 dB | 優秀 | 高質量通訊 |
| 0 - 10 dB | 良好 | 正常通訊 |
| -5 - 0 dB | 邊緣 | 通訊質量下降 |
| < -5 dB | 阻斷 | 無法正常通訊 |

### 阻斷判斷

| 條件 | 判斷 | 說明 |
|------|------|------|
| `SINR < SINR_th` | 被阻斷 | 通訊失效 |
| `SINR ≥ SINR_th` | 正常 | 通訊正常 |
| 典型閾值 | `-5 dB` | 本專案使用 |

### 在本專案中的實現

| 函數 | 功能 | 關鍵代碼 |
|------|------|----------|
| `calculate_sinr()` | 計算 SINR | `sinr_linear = P_Rx_W / (J_total_W + N_W)` |
| `is_jammed()` | 阻斷判斷 | `return sinr_dB < threshold_dB` |
| 干擾累加 | 多干擾源 | `J_total_W += 10**(P_rx_uav / 10)` |

### 計算範例

```python
# 1. 接收訊號功率 (dBW)
P_rx_dbw = -130.0

# 2. 各干擾源功率 (dBW)
J1_dbw = -120.0
J2_dbw = -125.0

# 3. 轉換為線性單位 (W)
P_rx_W = 10**(P_rx_dbw / 10)
J1_W = 10**(J1_dbw / 10)
J2_W = 10**(J2_dbw / 10)

# 4. 累加干擾
J_total_W = J1_W + J2_W

# 5. 計算噪聲 (假設 T_sys=290K, B=10MHz)
k = 1.380649e-23
T_sys = 290.0
B = 10e6
N_W = k * T_sys * B

# 6. 計算 SINR (線性)
sinr_linear = P_rx_W / (J_total_W + N_W)

# 7. 轉換為 dB
sinr_db = 10 * np.log10(sinr_linear)

# 8. 判斷是否被阻斷
is_jammed = sinr_db < -5.0
```

### SINR 與 BER 關係

| SINR (dB) | 近似 BER | 說明 |
|-----------|---------|------|
| 15 dB | < 10⁻⁶ | 極低錯誤率 |
| 10 dB | ~10⁻⁵ | 低錯誤率 |
| 5 dB | ~10⁻³ | 中等錯誤率 |
| 0 dB | ~10⁻² | 高錯誤率 |
| -5 dB | > 10⁻¹ | 極高錯誤率（基本無法通訊） |

### 多干擾源處理

| 情況 | 處理方法 | 說明 |
|------|---------|------|
| **相干干擾** | 功率相加（向量和） | 相位相關 |
| **非相干干擾** | 功率相加（標量和） | 本專案使用 |
| **部分相干** | 複雜模型 | 需考慮相位關係 |

### 注意事項

| 項目 | 說明 |
|------|------|
| **單位一致性** | 確保所有功率使用相同單位 |
| **線性運算** | 功率相加必須用線性單位（W） |
| **對數運算** | SINR 比值用線性，結果轉 dB |
| **噪聲模型** | 簡化為熱噪聲，實際還包括其他噪聲源 |
| **動態範圍** | 注意數值精度，避免下溢/上溢 |

### 性能指標

| 指標 | 計算方法 | 說明 |
|------|---------|------|
| **平均 SINR** | `mean(SINR_list)` | 所有終端的平均 SINR |
| **阻斷率** | `jammed_count / total_count` | 被阻斷終端比例 |
| **SINR 分佈** | 統計分析 | 最小值、最大值、標準差 |

### 優化目標

| 目標 | 函數 | 說明 |
|------|------|------|
| **最大化阻斷** | `maximize(jammed_count)` | 干擾方目標 |
| **最小化平均 SINR** | `minimize(mean(SINR))` | 等效目標 |
| **最大化覆蓋** | `maximize(jammed_area)` | 地理覆蓋 |

