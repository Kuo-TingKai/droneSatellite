# 電磁波傳播理論 Cheat Sheet
## 無線電傳播模型

### 核心公式

| 公式名稱 | 數學表達式 | 說明 |
|---------|-----------|------|
| **自由空間路徑損耗 (FSPL)** | `L_fs = 20*log₁₀(4πdf/c)` | 基本傳播損耗 |
| **Friis 傳輸公式** | `P_Rx = P_Tx + G_Tx + G_Rx - L_fs - L_atm` | 鏈路預算 |
| **功率轉換 (線性→dB)** | `P_dB = 10*log₁₀(P_W)` | 瓦特轉分貝瓦 |
| **功率轉換 (dB→線性)** | `P_W = 10^(P_dB/10)` | 分貝瓦轉瓦特 |

### 物理常數

| 常數 | 符號 | 數值 | 單位 |
|------|------|------|------|
| 光速 | `c` | 299,792,458 | m/s |
| 玻爾茲曼常數 | `k` | 1.380649×10⁻²³ | J/K |
| 地球半徑 | `R_earth` | 6,371,000 | m |

### 參數定義

| 參數 | 符號 | 單位 | 說明 |
|------|------|------|------|
| 發射功率 | `P_Tx` | dBW 或 W | 發射端功率 |
| 接收功率 | `P_Rx` | dBW 或 W | 接收端功率 |
| 發射增益 | `G_Tx` | dB | 發射天線增益 |
| 接收增益 | `G_Rx` | dB | 接收天線增益 |
| 距離 | `d` | m | 發射端到接收端距離 |
| 頻率 | `f` | Hz | 載波頻率 |
| 路徑損耗 | `L_fs` | dB | 自由空間路徑損耗 |
| 大氣衰減 | `L_atm` | dB | 大氣層衰減 |

### 距離計算

| 方法 | 公式 | 說明 |
|------|------|------|
| **3D 歐幾里得距離** | `d = √[(x₂-x₁)² + (y₂-y₁)² + (z₂-z₁)²]` | 三維空間距離 |
| **NumPy 實現** | `d = np.linalg.norm(coord1 - coord2)` | 向量範數 |

### 路徑損耗計算

| 類型 | 公式 | 適用場景 |
|------|------|----------|
| **自由空間 (FSPL)** | `L_fs = 20*log₁₀(4πdf/c)` | 理想真空環境 |
| **大氣衰減 (簡化)** | `L_atm ≈ 1-5 dB` (衛星-地面) | 長距離鏈路 |
| **大氣衰減 (簡化)** | `L_atm ≈ 0.5 dB` (無人機-地面) | 短距離鏈路 |

### 鏈路預算步驟

| 步驟 | 計算 | 說明 |
|------|------|------|
| 1. 計算距離 | `d = ||coord_Tx - coord_Rx||` | 三維距離 |
| 2. 計算 FSPL | `L_fs = 20*log₁₀(4πdf/c)` | 自由空間損耗 |
| 3. 估算大氣衰減 | `L_atm = f(altitude, distance)` | 根據高度和距離 |
| 4. 計算接收功率 | `P_Rx = P_Tx + G_Tx + G_Rx - L_fs - L_atm` | 完整鏈路預算 |

### 大氣衰減估算

| 鏈路類型 | 高度範圍 | 典型衰減 | 說明 |
|---------|---------|---------|------|
| **衛星-地面** | > 100 km | 1-5 dB | 穿越大氣層 |
| **無人機-地面** | 10-30 km | 0.3-0.7 dB | 平流層到地面 |
| **地面-地面** | < 1 km | 0.1-0.3 dB | 對流層 |

### 頻率與波長

| 頻率 | 波長 | 波段 | 應用 |
|------|------|------|------|
| 12 GHz | 2.5 cm | Ku-band | 衛星通訊 |
| 2.4 GHz | 12.5 cm | S-band | WiFi |
| 5.8 GHz | 5.2 cm | C-band | 雷達 |

### 在本專案中的實現

| 函數 | 功能 | 代碼片段 |
|------|------|----------|
| `calc_distance_3d()` | 計算距離 | `np.linalg.norm(coord1 - coord2)` |
| `calc_free_space_path_loss_db()` | FSPL | `20 * np.log10(4 * np.pi * d * f / c)` |
| `get_atmospheric_loss_db()` | 大氣衰減 | 根據高度和距離估算 |
| `calculate_link_budget()` | 完整鏈路預算 | `P_Tx + G_Tx + G_Rx - L_fs - L_atm` |

### 功率單位轉換

| 從 | 到 | 轉換公式 |
|----|----|---------|
| W (瓦特) | dBW | `P_dBW = 10*log₁₀(P_W)` |
| dBW | W | `P_W = 10^(P_dBW/10)` |
| dBm | dBW | `P_dBW = P_dBm - 30` |
| dBW | dBm | `P_dBm = P_dBW + 30` |

### 典型參數值

| 系統 | 發射功率 | 增益 | 頻率 |
|------|---------|------|------|
| **LEO 衛星** | 20 dBW (100W) | 30 dB | 12 GHz |
| **無人機干擾** | 10 dBW (10W) | 25 dB | 12 GHz |
| **地面終端** | - | 40 dB | 12 GHz |

### 距離與損耗關係

| 距離 | FSPL (12 GHz) | 說明 |
|------|--------------|------|
| 20 km | ~144 dB | 無人機-地面 |
| 550 km | ~178 dB | 衛星-地面 |
| 1000 km | ~182 dB | 長距離鏈路 |

### 注意事項

| 項目 | 說明 |
|------|------|
| **單位一致性** | 確保所有參數使用相同單位系統 |
| **對數運算** | 功率相加需先轉換為線性單位 |
| **大氣模型** | 簡化模型，實際應使用 ITU-R 標準 |
| **多徑效應** | 本專案未考慮，實際環境需考慮 |
| **極化** | 未考慮天線極化損失 |

### 進階模型

| 模型 | 說明 | 標準 |
|------|------|------|
| **ITU-R P.676** | 大氣氣體衰減 | ITU-R 建議 |
| **ITU-R P.526** | 繞射傳播 | ITU-R 建議 |
| **ITU-R P.618** | 雨衰模型 | ITU-R 建議 |
| **Okumura-Hata** | 城市環境傳播 | 移動通訊 |

